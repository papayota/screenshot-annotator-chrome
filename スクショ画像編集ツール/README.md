# スクリーンショット注釈エディタ Chrome拡張

画面のスクリーンショットを取得し、注釈（赤枠、矢印、番号）を追加してPNGとして保存できるChrome拡張機能です。

## 機能

- **スクリーンショット取得**: 表示中の範囲をスクリーンショットとして取得
- **ローカル画像読み込み**: ローカルにある画像ファイルを読み込んで編集可能
  - ファイル選択ボタンから画像を選択
  - ドラッグ&ドロップで画像を読み込み
- **注釈ツール**:
  - 矩形（赤枠）: ドラッグで矩形を描画
  - 矢印: ドラッグで矢印を描画
  - 番号: クリックで丸付き数字を配置（1〜9まで連番、大きめのサイズで見やすく表示）
- **Undo機能**: 最後の操作を1個戻すことができます
- **PNG保存**: 注釈を追加した画像をPNG形式でダウンロード

## インストール方法

### 1. Chrome拡張として読み込む

1. Chromeブラウザを開く
2. アドレスバーに `chrome://extensions/` と入力してEnter
3. 右上の「デベロッパーモード」を有効にする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. このプロジェクトのディレクトリを選択

## 使い方

### 画像の読み込み

#### スクリーンショットから
1. 任意のWebページを開く
2. ブラウザのツールバーにある拡張機能のアイコンをクリック
3. 自動的にスクリーンショットが取得され、編集画面が新しいタブで開きます

#### ローカル画像から
1. 編集画面の「📁 画像を開く」ボタンをクリックして画像ファイルを選択
   - または、画像ファイルを編集画面にドラッグ&ドロップ
2. 画像が読み込まれ、編集可能になります

### 注釈の追加

編集画面で以下のツールを使用できます：

#### 矩形ツール
1. ツールバーで「⬜ 矩形」を選択
2. Canvas上でドラッグして矩形を描画

#### 矢印ツール
1. ツールバーで「➡️ 矢印」を選択
2. Canvas上でドラッグして矢印を描画（開始点から終了点へ）

#### 番号ツール
1. ツールバーで「①② 番号」を選択
2. Canvas上をクリックして番号を配置
3. 1, 2, 3...と自動で連番が増えます（9まで、その後1に戻る）
4. 番号は大きめのサイズで表示され、見やすくなっています

### 1個戻る（Undo）

1. ツールバーの「↶ 1個戻る」ボタンをクリック
2. 最後に追加した注釈が1個削除されます
3. 複数回クリックすることで、複数の操作を順番に戻すことができます

### 保存

1. ツールバーの「💾 保存」ボタンをクリック
2. 注釈が追加された画像がPNG形式でダウンロードされます
3. ファイル名は `annotated-YYYYMMDD-HHMMSS.png` の形式です

### クリア

1. ツールバーの「🗑️ クリア」ボタンをクリック
2. 確認ダイアログで「OK」を選択
3. すべての注釈が削除されます

## プロジェクト構成

```
スクショ画像編集ツール/
├── manifest.json          # Manifest V3設定
├── service_worker.js      # スクショ取得、editor起動、データ保存
├── editor.html            # 編集画面HTML
├── editor.css             # 編集画面スタイル
├── editor.js              # 注釈UI + 描画 + 保存
├── icons/                 # 拡張アイコン（既に含まれています）
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
├── generate-icons.py      # アイコン生成スクリプト（Python）
├── docs/                  # ドキュメント
│   ├── requirements.md
│   ├── tasks.md
│   ├── architecture.md
│   ├── api-spec.md
│   └── implementation-notes.md
└── README.md              # このファイル
```

## 技術スタック

- **Manifest V3**: Chrome拡張の最新仕様
- **Canvas API**: 2D Contextを使用した描画
- **Chrome APIs**:
  - `chrome.tabs.captureVisibleTab`: スクリーンショット取得
  - `chrome.storage.local`: 画像データの一時保存
  - `chrome.downloads.download`: PNGファイルのダウンロード
  - `chrome.tabs.create`: 編集画面の起動
- **JavaScript**: バニラJS（フレームワーク不要）

## 制約事項

- 外部API・外部通信なし（完全ローカル完結）
- 画像データは `chrome.storage.local` に一時保存（約10MB制限）
- 表示中の範囲のみをスクリーンショット（ページ全体のスクロール領域は含まない）

## アイコンファイルの再生成

アイコンファイルを再生成したい場合は、以下のコマンドを実行してください：

```bash
python3 generate-icons.py
```

**必要な環境**: Python 3 + Pillow ライブラリ

Pillowがインストールされていない場合は、以下のコマンドでインストールできます：

```bash
pip install Pillow
```

## トラブルシューティング

### スクリーンショットが取得できない

- 拡張機能の権限を確認してください
- タブが完全に読み込まれていることを確認してください

### 画像が表示されない

- ブラウザのコンソール（F12）でエラーメッセージを確認してください
- `chrome.storage.local` の容量制限に達していないか確認してください

### 保存ができない

- ダウンロード権限が有効になっているか確認してください
- ブラウザのダウンロード設定を確認してください

## ライセンス

このプロジェクトは個人利用・学習目的で作成されています。

## 更新履歴

### v1.0.0 (2024)
- 初回リリース
- スクリーンショット取得機能
- 3種類の注釈ツール（矩形、矢印、番号）
- Undo機能（1個戻る）
- PNG保存機能

